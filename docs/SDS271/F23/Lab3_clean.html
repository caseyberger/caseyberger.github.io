<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Casey E. Berger – lab3_clean</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"headline",
  "consent_type":"express",
  "palette":"dark",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  });
});
</script> 
  


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Casey E. Berger</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-about-me" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">About Me</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-about-me">    
        <li>
    <a class="dropdown-item" href="../../bio.html" rel="" target="">
 <span class="dropdown-text">About Me</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../cv_and_pubs.html" rel="" target="">
 <span class="dropdown-text">CV and Publications</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-teaching-and-pedagogy" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Teaching and Pedagogy</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-teaching-and-pedagogy">    
        <li>
    <a class="dropdown-item" href="../../teaching_philosophy.html" rel="" target="">
 <span class="dropdown-text">Teaching Philosophy</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../inclusive_classroom.html" rel="" target="">
 <span class="dropdown-text">Building an Inclusive Classroom</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-data-science-in-the-physics-classroom" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Data Science in the Physics Classroom</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-data-science-in-the-physics-classroom">    
        <li>
    <a class="dropdown-item" href="../../beginning_python.html" rel="" target="">
 <span class="dropdown-text">Beginning Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../python_data_science.html" rel="" target="">
 <span class="dropdown-text">Teaching Data Science to Physics Students</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-sds-271-fall-2023" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">SDS 271 Fall 2023</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-sds-271-fall-2023">    
        <li>
    <a class="dropdown-item" href="../../sds-271-f23.html" rel="" target="">
 <span class="dropdown-text">SDS 271 Fall 2023</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../SDS271/F23/Lab1_clean.html" rel="" target="">
 <span class="dropdown-text">Lab 1: Getting Started</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../SDS271/F23/Lab1_solutions.html" rel="" target="">
 <span class="dropdown-text">Lab 1 solutions: Welcome to SDS 271!</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../SDS271/F23/Lab2_clean.html" rel="" target="">
 <span class="dropdown-text">Lab 2: Statistics and Betting</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../SDS271/F23/Lab2_solutions.html" rel="" target="">
 <span class="dropdown-text">Lab 2 solutions: Statistics and Betting</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../SDS271/F23/Lab3_clean.html" rel="" target="">
 <span class="dropdown-text">Lab 3: Intro to Pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../SDS271/F23/Lab4_clean.html" rel="" target="">
 <span class="dropdown-text">Lab 4: Data Science Libraries in Python</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../SDS271/F23/Lab3_clean.html">Lab 3: Intro to Pandas</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../sds-271-f23.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SDS 271 Fall 2023</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../SDS271/F23/Lab1_clean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 1: Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../SDS271/F23/Lab1_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 1 solutions: Welcome to SDS 271!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../SDS271/F23/Lab2_clean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 2: Statistics and Betting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../SDS271/F23/Lab2_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 2 solutions: Statistics and Betting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../SDS271/F23/Lab3_clean.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Lab 3: Intro to Pandas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../SDS271/F23/Lab4_clean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 4: Data Science Libraries in Python</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#lab-3-intro-to-pandas" id="toc-lab-3-intro-to-pandas" class="nav-link active" data-scroll-target="#lab-3-intro-to-pandas">Lab 3: Intro to Pandas</a>
  <ul class="collapse">
  <li><a href="#pandas-basic-structures-and-operations" id="toc-pandas-basic-structures-and-operations" class="nav-link" data-scroll-target="#pandas-basic-structures-and-operations">Pandas: basic structures and operations</a>
  <ul class="collapse">
  <li><a href="#series" id="toc-series" class="nav-link" data-scroll-target="#series">Series</a></li>
  <li><a href="#dataframes" id="toc-dataframes" class="nav-link" data-scroll-target="#dataframes">DataFrames</a></li>
  </ul></li>
  <li><a href="#more-advanced-operations-with-pandas" id="toc-more-advanced-operations-with-pandas" class="nav-link" data-scroll-target="#more-advanced-operations-with-pandas">More advanced operations with Pandas</a>
  <ul class="collapse">
  <li><a href="#working-with-lists-in-columns" id="toc-working-with-lists-in-columns" class="nav-link" data-scroll-target="#working-with-lists-in-columns">Working with lists in columns</a></li>
  <li><a href="#creating-a-new-column-from-old-columns" id="toc-creating-a-new-column-from-old-columns" class="nav-link" data-scroll-target="#creating-a-new-column-from-old-columns">Creating a new column from old columns</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#post-lab-production-and-reflection" id="toc-post-lab-production-and-reflection" class="nav-link" data-scroll-target="#post-lab-production-and-reflection">Post-Lab: Production and Reflection</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="lab-3-intro-to-pandas" class="level1">
<h1>Lab 3: Intro to Pandas</h1>
<section id="pandas-basic-structures-and-operations" class="level2">
<h2 class="anchored" data-anchor-id="pandas-basic-structures-and-operations">Pandas: basic structures and operations</h2>
<div class="alert alert-info">
<p>Exercise 1: Import the following packages that you’ve already seen to this notebook:</p>
<ul>
<li>
numpy (as np)
</li>
<li>
pyplot from matplotlib (as plt)
</li>
</ul>
</div>
<div class="alert alert-info">
<p>Exercise 2:</p>
<p>Now, import this new package called Pandas. Traditionally, it’s imported with “nickname” pd</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="series" class="level3">
<h3 class="anchored" data-anchor-id="series">Series</h3>
<p>The heart of Pandas is an object called a “<a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html">Series</a>.” This is kind of like a numpy array, but with the labeling of a dictionary.</p>
<div class="alert alert-info">
<p>Exercise 3:</p>
<p>Generate a numpy array of random numbers of some medium-sized length (say, 30 - you can do this with <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.rand.html">numpy</a> or with the <a href="https://docs.python.org/3/library/random.html">random</a> module you’ve imported for previous labs. Note that you will need to import random if you want to use that module, but numpy is already imported.</p>
<p>Now that you have the numpy array, convert it to a pandas Series using the <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html ">pd.Series()</a> function.</p>
<p>Finally, explore that series. If you look at the Series documentation, you will see that a Series type has dozens of built-in function you can use. To simplify, start with:</p>
<ul>
<li>
describe()
</li>
<li>
head()
</li>
<li>
tail()
</li>
<li>
count()
</li>
<li>
one additional function of your choice from the list on the left of the documentation
</li>
</ul>
<p>Note: you can also convert this series back to a numpy array using the to_numpy() function!</p>
</div>
<section id="series-and-dictionaries" class="level4">
<h4 class="anchored" data-anchor-id="series-and-dictionaries">Series and dictionaries</h4>
<p>You can also make a series from a dictionary. In Moodle, you will find a link to a Google Sheet which stores the information we gathered on the first day of class: names, majors and minors, class year, and hometown.</p>
<div class="alert alert-info">
<p>Exercise 3:</p>
<p>Go to the Google Sheet and take a look. Then make a dictionary: the key should be the name (combine first and last here to avoid duplicates) and the value should be the class year (e.g.&nbsp;for Casey, we need to use “np.NAN” to indicate there is no number). Name this dictionary whatever you want.</p>
<p>Then, use the pd.Series() function to convert this dictionary to a series. Examine it just as you examined the other string – what is different?</p>
</div>
<p>Be careful with indexing in pandas series. It’s more like a dictionary than an array. To find the ith element, use the iloc attribute, for example (I named my series “class_year”):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>class_year.iloc[<span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In general, it’s better to use keys and .loc than indexing and .iloc. If I want to find what my class year is, I would do:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>class_year[<span class="st">"Casey Berger"</span>]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="st">'NaN'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This is fine to do in a simple dataset, but the best practice is to use <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.loc.html">.loc</a>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>class_year.loc[<span class="st">"Casey Berger"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="filtering-a-series" class="level4">
<h4 class="anchored" data-anchor-id="filtering-a-series">Filtering a series</h4>
<p>You can filter a series by index or by values. For example, maybe I only want the list of seniors graduating in May in the class. That’s class year 2024. I can create a “mask” that will select only students with that class year:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>senior_mask <span class="op">=</span> class_year <span class="op">==</span> <span class="dv">2024</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>senior_mask</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Don’t forget that in Python, a single equals sign is an assignment while a double equals sign insists on equivalence!</p>
<p>If you print the mask, you can see that it’s created a boolean filter – everything is either “true” if the class year is 2024 or “false” otherwise.</p>
<p>Now, I can filter the list by plugging that “mask” into the series:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>seniors <span class="op">=</span> class_year[senior_mask]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seniors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can use masks with the .loc technique as well (for more details, including an explanation of the difference between .loc and .iloc, check out <a href="https://towardsdatascience.com/everything-you-need-to-know-about-loc-and-iloc-of-pandas-79b386cac776">this great article from Towards Data Science</a>), so you will want to work with this formulation when you are doing complicated, multi-step filtering, cleaning, and manipulating on a dataset.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>seniors <span class="op">=</span> class_year.loc[senior_mask]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seniors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="alert alert-info">
<p>Exercise 4:</p>
<p>Create a mask that filters the series by students that are graduating AFTER spring 2024 (all non-seniors).</p>
</div>
<div class="alert alert-success">
<p>Stop when you get here. Check in with <a href="https://app.sli.do/event/oW3TqWDfB2CyvKPYBG8YJD/embed/polls/d5aeb700-8b15-4246-a7b5-0fee73fdafa0"> slido</a>, then help your neighbor, work on a project, etc.</p>
</div>
</section>
</section>
<section id="dataframes" class="level3">
<h3 class="anchored" data-anchor-id="dataframes">DataFrames</h3>
<p>A DataFrame is a stack of Series. While every object in a series must have the same type, you can stack together series of different types to make a dataframe. You can filter dataframes just like you can filter series, and the use of keys can be very helpful here!</p>
<p>With series, we created them from numpy arrays and dictionaries, but most of the time with dataframes, we will start by importing a file (most often .csv). This is very easy to do in Pandas.</p>
<div class="alert alert-info">
<p>Exercise 5:</p>
<p>Upload the .csv file in Moodle (this is the same data as the Google sheet) to your JupyterHub in the same directory as this notebook. Then, create a dataframe (let’s call it “class_data” for simplicity) using the read_csv function.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>class_data <span class="op">=</span> pd.read_csv(<span class="st">"SDS271_class_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can use many of the same functions to examine a dataframe as a series: try this with describe(), head(), and tail()</p>
<p>But there’s more going on here. Try the following:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>class_data.columns</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>class_data.dtypes</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>class_data.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, I can filter this data, but I need to specify which column (or series) my filter applies to.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>non_senior_mask <span class="op">=</span> class_data[<span class="st">"Class year"</span>] <span class="op">&gt;</span> <span class="dv">2024</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>non_senior_df <span class="op">=</span> class_data[non_senior_mask]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>non_senior_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="alert alert-info">
<p>Exercise 6:</p>
<p>Try creating some masks for this dataframe. What are some of the limitations you encounter as you try to filter things?</p>
</div>
<div class="alert alert-success">
<p>Once you’ve got the hang of making masks, check-in with <a href="https://app.sli.do/event/oW3TqWDfB2CyvKPYBG8YJD/embed/polls/78afb36d-e857-496a-8eaa-fc4e05cc36da"> slido</a>. Then, make some more masks, help your neighbor, whatever will help you get more comfortable with this material.</p>
</div>
</section>
</section>
<section id="more-advanced-operations-with-pandas" class="level2">
<h2 class="anchored" data-anchor-id="more-advanced-operations-with-pandas">More advanced operations with Pandas</h2>
<p>When working with small, simple datasets, we can use reasonably simple operations. But as our datasets get larger and more complicated, we need to use new methods to ensure that we are making the changes we expect.</p>
<p>To learn some of these techniques, we are going to use a new dataset.</p>
<div class="alert alert-info">
<p>Exercise 7:</p>
<p>Download the Pokemon dataset from Moodle and read it in here. Take a few minutes to explore the dataset. What do you notice about it? What is in it? How is it organized?</p>
<p>Discuss with your neighbor for a few minutes. Together, come up with a way to answer this question: what is the most common primary type of the Pokemon in the dataset?</p>
</div>
<section id="working-with-lists-in-columns" class="level3">
<h3 class="anchored" data-anchor-id="working-with-lists-in-columns">Working with lists in columns</h3>
<p>Motivating question: What is the most common ability among the Pokemon in our dataset?</p>
<div class="alert alert-info">
<p>Exercise 8:</p>
<p>Try using the same method you used to find the most common type to determine the most common ability. What goes wrong?</p>
</div>
<div class="alert alert-success">
<p>Describe this to the best of your ability in <a href="https://app.sli.do/event/fRBPow4oPaDLqj5NGDJiW2/embed/polls/c21a7d24-35e6-47ff-a248-47253d033dd1"> sli.do</a>. You can answer together with your neighbor if you want.</p>
</div>
<p>Let’s take a closer look at the column together to see what’s happening.</p>
<p>What is the type of these entries? Pandas says object, which often means string. Let’s check with Python.</p>
<p>We need to use the Python <a href="https://realpython.com/python-eval-function/#understanding-pythons-eval">eval</a> function here to read the string as a list. We can do this by applying the eval function to each entry in the column.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>pk_df.loc[:,<span class="st">"abilities"</span>].<span class="bu">apply</span>(<span class="bu">eval</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>pk_df.loc[:,<span class="st">"abilities"</span>] <span class="op">=</span> pk_df.loc[:,<span class="st">"abilities"</span>].<span class="bu">apply</span>(<span class="bu">eval</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>pk_df[<span class="st">"abilities"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now that we have a list object instead of a string, we can use value_counts. But first, we have to use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.explode.html">explode</a> function so that it pulls out each entry in each list and counts it separately. We can chain these operations together.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pk_df[<span class="st">"abilities"</span>].explode().value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="creating-a-new-column-from-old-columns" class="level3">
<h3 class="anchored" data-anchor-id="creating-a-new-column-from-old-columns">Creating a new column from old columns</h3>
<p>We’ve now been able to determine the most common abilities in the dataset, but how many abilities does each Pokemon have on average? Do they all have the same number, or does it vary? We can create a new column with this information using a <a href="https://realpython.com/python-lambda/">lambda function</a> and apply.</p>
<p><em>note: you can define a whole function yourself to apply here, but it’s shorter and more efficient to use a lambda function</em></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>pk_df.loc[:,<span class="st">"num_abilities"</span>] <span class="op">=</span> pk_df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">len</span>(x[<span class="st">'abilities'</span>]),axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Alternative version:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_abilities(x):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">len</span>(x[<span class="st">"abilities"</span>])</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>pk_df.loc[:,<span class="st">"num_abilities_alt"</span>] <span class="op">=</span> pk_df.<span class="bu">apply</span>(count_abilities,axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you want, try both versions and see that they do the same thing. If you are more comfortable defining a function and applying it than using lambda functions, that is okay. But over time, you should start to get more comfortable with lambda functions.</p>
<p><img src="./graphics/pokemon-happy-pikachu.gif" class="img-fluid"></p>
</section>
</section>
</section>
<section id="post-lab-production-and-reflection" class="level1">
<h1>Post-Lab: Production and Reflection</h1>
<p>When you are done with this lab, make sure you save and export it as an HTML. This HTML file is what you will turn in through Moodle. In addition, don’t forget to fill out the <a href="https://forms.gle/1rQ9GLgEyuReK1xj7">post-lab reflection form</a>. You must turn in both an HTML that demonstrates you have completed the lab and a self-reflection to get credit.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center"><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>